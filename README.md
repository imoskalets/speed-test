# SPEED TEST MONGO vs MARIA


Before: 
- **users**: 120 items
- **maria::policies**: 14293 items
- **mongo::policies**: 14371 items

After:
- **users**: 120 items
- **maria::policies**: 15482 items
- **mongo::policies**: 15404 items

Indexes:
- mongo: **user_id**
- maria: **user_id**

Example query:
```
select:
mongo: where(:'data.car.mileage'.gte => mileage, 'data.car.fuel' => fuel)
maria: where("JSON_EXTRACT(data, '$.car.mileage') > ? AND JSON_EXTRACT(data, '$.car.fuel') = ?", mileage, fuel )

--------
update:
mongo: update_all('coverages.total_sum' => total_sum)
maria: update_all("data = JSON_REPLACE(data, '$.coverages.total_sum', #{total_sum})")
```

**<u>Insert</u>**
```
------------------------1------------------------
            user     system      total        real
MONGO   0.015848   0.004739   0.020587 (  0.021808)
MARIA   0.015406   0.003457   0.018863 (  0.021295)


------------------------10------------------------
            user     system      total        real
MONGO   0.076257   0.032321   0.108578 (  0.111368)
MARIA   0.065257   0.020848   0.086105 (  0.106059)


------------------------100------------------------
            user     system      total        real
MONGO   0.793507   0.315139   1.108646 (  1.127626)
MARIA   0.626646   0.183851   0.810497 (  0.974932)

------------------------1000------------------------
            user     system      total        real
MONGO   8.567147   3.452458  12.019605 ( 12.229307)
MARIA   6.009636   1.792836   7.802472 (  9.323282)
```

**<u>Update</u>**
```
------------------------1------------------------
            user     system      total        real
MONGO   0.014857   0.003187   0.018044 (  0.019642)
MARIA   0.033802   0.006870   0.040672 (  0.046830)

------------------------10------------------------
            user     system      total        real
MONGO   0.037160   0.011791   0.048951 (  0.052441)
MARIA   0.069295   0.020607   0.089902 (  0.113766)

------------------------100-----------------------
            user     system      total        real
MONGO   0.346351   0.101904   0.448255 (  0.488073)
MARIA   0.688045   0.176878   0.864923 (  1.047089)

------------------------1000----------------------
            user     system      total        real
MONGO   3.515627   0.923709   4.439336 (  4.616920)
MARIA   6.949127   1.846595   8.795722 ( 10.766267)

```

**<u>Update by query</u>**
```
------------------------1------------------------
            user     system      total        real
MONGO   0.002123   0.000226   0.002349 (  0.003046)
MARIA   0.000551   0.000043   0.000594 (  0.005455)

------------------------10------------------------
            user     system      total        real
MONGO   0.010957   0.001151   0.012108 (  0.025361)
MARIA   0.006580   0.000638   0.007218 (  0.074800)

------------------------100-----------------------
            user     system      total        real
MONGO   0.100502   0.005405   0.105907 (  0.244283)
MARIA   0.055916   0.003775   0.059691 (  0.623143)

------------------------1000-----------------------
            user     system      total        real
MONGO   1.149014   0.060276   1.209290 (  2.760187)
MARIA   0.573758   0.039863   0.613621 (  6.082397)

```

**<u>Select</u>**

```
------------------------1------------------------
            user     system      total        real
MONGO   0.078180   0.036643   0.114823 (  0.143195)
MARIA   0.022009   0.010853   0.032862 (  0.180434)

------------------------10-----------------------
            user     system      total        real
MONGO   0.618825   0.312132   0.930957 (  1.097208)
MARIA   0.234873   0.116269   0.351142 (  1.836387)

------------------------100-----------------------
            user     system      total        real
MONGO   6.583393   3.252839   9.836232 ( 11.642244)
MARIA   2.365268   1.150788   3.516056 ( 18.955804)

------------------------1000----------------------
            user     system      total        real
MONGO  63.463584  31.178252  94.641836 (113.147485)
MARIA  23.433168  11.434744  34.867912 (206.121587)

```

**<u>Select by index</u>**
```
------------------------1------------------------
            user     system      total        real
MONGO   0.004774   0.001531   0.006305 (  0.006982)
MARIA   0.002561   0.001406   0.003967 (  0.004994)

------------------------10-----------------------
            user     system      total        real
MONGO   0.032195   0.012025   0.044220 (  0.048728)
MARIA   0.013152   0.004830   0.017982 (  0.020871)

------------------------100-----------------------
            user     system      total        real
MONGO   0.271589   0.083164   0.354753 (  0.388190)
MARIA   0.110142   0.037382   0.147524 (  0.170691)

------------------------1000----------------------
            user     system      total        real
MONGO   2.752948   0.829556   3.582504 (  3.900574)
MARIA   1.100287   0.350327   1.450614 (  1.664076)
```

**<u>First</u>**
```
------------------------1------------------------
            user     system      total        real
MONGO   0.003107   0.001014   0.004121 (  0.004321)
MARIA   0.001100   0.000389   0.001489 (  0.001769)

------------------------10------------------------
            user     system      total        real
MONGO   0.036106   0.012437   0.048543 (  0.052876)
MARIA   0.011463   0.004209   0.015672 (  0.018203)

------------------------100------------------------
            user     system      total        real
MONGO   0.283237   0.097215   0.380452 (  0.397973)
MARIA   0.107875   0.036120   0.143995 (  0.170035)

------------------------1000------------------------
            user     system      total        real
MONGO   2.910131   0.903863   3.813994 (  3.912491)
MARIA   1.076565   0.352179   1.428744 (  1.669554)
```


**<u>Count</u>**
```
------------------------1------------------------
            user     system      total        real
MONGO   0.001080   0.000103   0.001183 (  0.017729)
MARIA   0.000819   0.000073   0.000892 (  0.165602)

------------------------10------------------------
            user     system      total        real
MONGO   0.011855   0.000799   0.012654 (  0.175100)
MARIA   0.006581   0.000444   0.007025 (  1.615934)

------------------------100------------------------
            user     system      total        real
MONGO   0.117247   0.006441   0.123688 (  1.815652)
MARIA   0.069070   0.005028   0.074098 ( 15.476410)

------------------------1000-----------------------
            user     system      total        real
MONGO   1.214692   0.060559   1.275251 ( 19.043598)
MARIA   0.646965   0.049302   0.696267 (177.050364)
```

**<u>Count by index</u>**
```
------------------------1------------------------
         user     system      total        real
MONGO   0.001355   0.000134   0.001489 (  0.001494)
MARIA   0.000786   0.000037   0.000823 (  0.001088)

------------------------10------------------------
            user     system      total        real
MONGO   0.013833   0.001096   0.014929 (  0.016505)
MARIA   0.004885   0.000299   0.005184 (  0.007110)

------------------------100-----------------------
            user     system      total        real
MONGO   0.102959   0.005446   0.108405 (  0.119220)
MARIA   0.050442   0.004030   0.054472 (  0.073883)

------------------------1000-----------------------
            user     system      total        real
MONGO   0.889312   0.047378   0.936690 (  1.011062)
MARIA   0.442030   0.032262   0.474292 (  0.644238)

```